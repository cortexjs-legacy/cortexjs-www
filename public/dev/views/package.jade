include ./mixin/component

extends layout/default.jade

block head  
	title cortex
	+css("/css/package.css")
	+css("/css/lib/readme.css")

block content  
	+nav(user)
	section.container
		.top-area
			span.info #{pkg.name}
			select.versions(onchange="window.location = '/package/#{pkg.name}/'+this.options[this.selectedIndex].value")
				each version in pkg.allVersions
					if version == pkg.version
						option(selected="true", value="#{version}") #{version}
					else
						option(value="#{version}") #{version}
			if pkg.license
				a(href="#{pkg.license.url}").info-box 
					span #{pkg.license.name}
			if user
				.tags
					if tags && tags.length>0
						each tag in tags
							a.tag #{tag}
				
				a.add-tag `
				input.tag-input(type="text" class="hide")
		.detail
			.main-col
				+package-stat(pkg)
				section.readme.card
					.title README
					.content.markdown !{pkg.readme}
			.aside-col
				.dependency-info.card
					.tabs
						a.tab.active DEPS
						a.tab DEV
						a.tab DEPENDENTS
					.tab-panes
						.content.tab-pane.active
							table
								thead
									tr
										th NAME
										th REQUIREMENT
								tbody
									each version, dependency in pkg.dependencies
										tr
											td
												a(href="/package/#{dependency}") #{dependency}
											td 
												a(href="/package/#{dependency}/#{version}") #{version}
						if pkg.asyncDependencies && pkg.asyncDependencies.length
							.content.tab-pane
								table
									thead
										tr
											th NAME
											th REQUIREMENT
									tbody
										each version, dependency in pkg.asyncDependencies
											tr
												td 
													a(href="/package/#{dependency}") #{dependency}
												td 
													a(href="/package/#{dependency}/#{version}") #{version}
						.content.tab-pane
							table
								thead
									tr
										th NAME
										th REQUIREMENT
								tbody
									each version, dependency in pkg.devDependencies
										tr
											td 
												a(href="/package/#{dependency}") #{dependency}
											td 
												a(href="/package/#{dependency}/#{version}") #{version}
						.content.tab-pane
							table
								thead
									tr
										th NAME
										th DESCRIPTION
								tbody
									each dependency in pkg.dependents
										tr
											td 
												a(href="/package/#{dependency.name}") #{dependency.name}
											td.ellipsis #{dependency.description}
				+maintainers(pkg.maintainers)

	script.
		facade({
			mod: 'cortexjs-www/entries/package'
		});


